# test_task_2

<b>Задание 2.</b>

   Создал базу, файлы создания в `modules/orm.local/lib`. Так же <br> 
   настроил для них связь.

1) Для этого задания я создал файл контроллер `WorkDayController.php`<br>
   На него с класса компонента приходят данные для работы, а в класс <br> 
   они попадают из шаблона через пост запрос. Далее дергается нужный <br>
   метод и данные попадают в базу.


2) Логика такая так как у нас скрипт запускается каждый час по 1 разу.<br>
   То я создал свойство модуля в который записываю каждый так сказать <br>
   проход скрипта. Когда колличество доходит до 24 (последнего раза за <br>
   день), происходит сбор всех логинов с временем и записываеться <br> 
   время полночи след дня. Данное задание я записал в агенты (путь к <br> 
   ним `local/php_iterface/include/agents.php`), но их можно запустить и на крон.


3) Тут идет сбор текущей даты. Потом поиск в ней людей которые <br>
опоздали потом их запись в другую таблицу.


   2 заданея я бы сделал по другому и описал методом `CheckUserCount_2()` <br>
   в конце файла. Мне кажется тут нужно просто взять посмотреть нету <br> 
   ли за ВЧЕРАШНИЙ день записей о старте работы без пометки о <br> завершении
   (тоесть если колонка DATE_STOP) пустая тоесть просто 1 <br>
   запрос всегда, ищешь все записи с датой начала но без даты <br> окончания за ВЧЕРА, 
   и всем им проставлешь нужное окончание.